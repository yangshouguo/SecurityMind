diff -p -u -1 -2 -r3.25 nsTablePainter.cpp
--- a/layout/tables/nsTablePainter.cpp	21 Mar 2008 01:19:13 -0000	3.25
+++ n/layout/tables/nsTablePainter.cpp	25 Apr 2008 21:42:38 -0000
@@ -604,24 +604,27 @@ TableBackgroundPainter::PaintCell(nsTabl
   NS_PRECONDITION(aCell, "null frame");
 
   const nsStyleTableBorder* cellTableStyle;
   cellTableStyle = aCell->GetStyleTableBorder();
   if (!(NS_STYLE_TABLE_EMPTY_CELLS_SHOW == cellTableStyle->mEmptyCells ||
         NS_STYLE_TABLE_EMPTY_CELLS_SHOW_BACKGROUND == cellTableStyle->mEmptyCells)
       && aCell->GetContentEmpty()) {
     return NS_OK;
   }
 
   PRInt32 colIndex;
   aCell->GetColIndex(colIndex);
+  NS_ASSERTION(colIndex < mNumCols, "prevent array boundary violation");
+  if (mNumCols <= colIndex)
+    return NS_OK;
 
   //Paint column group background
   if (mCols && mCols[colIndex].mColGroup && mCols[colIndex].mColGroup->IsVisible()) {
     nsCSSRendering::PaintBackgroundWithSC(mPresContext, mRenderingContext,
                                           mCols[colIndex].mColGroup->mFrame, mDirtyRect,
                                           mCols[colIndex].mColGroup->mRect + mRenderPt,
                                           *mCols[colIndex].mColGroup->mBackground,
                                           *mCols[colIndex].mColGroup->mBorder,
                                           mZeroPadding, PR_TRUE, &mCellRect);
   }
 
   //Paint column background
