diff --git a/js/src/json.cpp b/js/src/json.cpp
--- a/js/src/json.cpp
+++ b/js/src/json.cpp
@@ -241,20 +241,20 @@ WriteIndent(JSContext *cx, StringifyCont
 
 static JSBool
 JO(JSContext *cx, jsval *vp, StringifyContext *scx)
 {
     JSObject *obj = JSVAL_TO_OBJECT(*vp);
 
     if (!scx->cb.append('{'))
         return JS_FALSE;
 
-    jsval vec[3] = {JSVAL_NULL, JSVAL_NULL, JSVAL_NULL};
-    JSAutoTempValueRooter tvr(cx, 3, vec);
+    jsval vec[] = {JSVAL_NULL, JSVAL_NULL, JSVAL_NULL, *vp};
+    JSAutoTempValueRooter tvr(cx, JS_ARRAY_LENGTH(vec), vec);
     jsval& key = vec[0];
     jsval& outputValue = vec[1];
 
     JSObject *iterObj = NULL;
     jsval *keySource = vp;
     bool usingWhitelist = false;
 
     // if the replacer is an array, we use the keys from it
     if (scx->replacer && JS_IsArrayObject(cx, scx->replacer)) {
